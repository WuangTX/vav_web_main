{% extends 'base.html' %}
{% load static %}
{% load humanize %}

{% block title %}Sản Phẩm - VAV Furniture{% endblock %}

{% block content %}
<!-- Page Header -->
<section class="page-header">
    <div class="container">
        <div class="page-header-content text-center">
            <h1 class="display-4 fw-bold">Sản Phẩm</h1>
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb justify-content-center">
                    <li class="breadcrumb-item"><a href="{% url 'home' %}" class="text-white">Trang Chủ</a></li>
                    <li class="breadcrumb-item active text-white" aria-current="page">Sản Phẩm</li>
                </ol>
            </nav>
        </div>
    </div>
</section>

<!-- Products Section -->
<section class="products-section py-5">
    <div class="container">
        <!-- Search and Filter Row -->
        <div class="row mb-4">
            <div class="col-md-6 mb-3 mb-md-0">
                <form action="{% url 'products' %}" method="get" class="search-form">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Tìm kiếm sản phẩm..." name="search" value="{{ request.GET.search|default:'' }}">
                        <button class="btn btn-primary" type="submit"><i class="fas fa-search"></i></button>
                    </div>
                </form>
            </div>
            <div class="col-md-6">
                <div class="d-flex justify-content-md-end">
                    <select class="form-select" style="max-width: 200px;">
                        <option value="default">Sắp xếp mặc định</option>
                        <option value="price-asc">Giá: Thấp đến cao</option>
                        <option value="price-desc">Giá: Cao đến thấp</option>
                        <option value="newest">Mới nhất</option>
                    </select>
                </div>
            </div>
        </div>
        
        <!-- Products Filter -->
        <div class="product-filters text-center mb-5">
            <button class="filter-button active" data-filter="all">Tất Cả</button>
            {% for category in categories %}
            <button class="filter-button" data-filter="{{ category.slug }}">{{ category.name }}</button>
            {% endfor %}
        </div>
          <div class="row g-4">
            {% if products %}
                {% for product in products %}
                <!-- Product Item {{ forloop.counter }} -->
                <div class="col-md-6 col-lg-3 product-item {{ product.category.slug }}">
                    <div class="product-card">                        
                        <div class="product-image">
                            <img src="{{ product.image.url }}" alt="{{ product.name }}" class="img-fluid">
                            <div class="product-overlay">
                                <a href="{% url 'product_detail' product.slug %}" class="btn btn-sm btn-outline-light">Xem Chi Tiết</a>
                            </div>
                        </div>
                        <div class="product-info p-3">
                            <h5>{{ product.name }}</h5>
                            <p class="text-muted">{{ product.category.name }}</p>
                            <div class="product-price">
                                <span class="price">{{ product.price|floatformat:0|intcomma }} ₫</span>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            {% else %}
                <div class="col-12 text-center">
                    <p>Không có sản phẩm nào.</p>
                </div>
            {% endif %}        </div>
        
        <!-- Pagination -->
        {% if products.has_other_pages %}
            <div class="pagination-custom">
                {% if products.has_previous %}
                    <a href="?page=1{% if search_query %}&search={{ search_query }}{% endif %}{% if category %}&category={{ category.slug }}{% endif %}" class="page-link">Đầu</a>
                    <a href="?page={{ products.previous_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}{% if category %}&category={{ category.slug }}{% endif %}" class="page-link">Trước</a>
                {% endif %}

                {% for num in products.paginator.page_range %}
                    {% if products.number == num %}
                        <span class="page-link active">{{ num }}</span>
                    {% elif num > products.number|add:'-3' and num < products.number|add:'3' %}
                        <a href="?page={{ num }}{% if search_query %}&search={{ search_query }}{% endif %}{% if category %}&category={{ category.slug }}{% endif %}" class="page-link">{{ num }}</a>
                    {% endif %}
                {% endfor %}

                {% if products.has_next %}
                    <a href="?page={{ products.next_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}{% if category %}&category={{ category.slug }}{% endif %}" class="page-link">Sau</a>
                    <a href="?page={{ products.paginator.num_pages }}{% if search_query %}&search={{ search_query }}{% endif %}{% if category %}&category={{ category.slug }}{% endif %}" class="page-link">Cuối</a>
                {% endif %}
            </div>
        {% endif %}
    </div>
</section>

<!-- Custom Furniture CTA -->
<section class="custom-furniture-cta py-5">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-6 mb-4 mb-lg-0">
                <img src="{% static 'images/custom-furniture.jpg' %}" alt="Nội Thất Theo Yêu Cầu" class="img-fluid rounded shadow">
            </div>
            <div class="col-lg-6">
                <div class="section-heading mb-4">
                    <h6 class="text-primary">Dịch Vụ Đặc Biệt</h6>
                    <h2>Nội Thất Theo Yêu Cầu</h2>
                </div>
                <p>VAV Furniture cung cấp dịch vụ thiết kế và sản xuất nội thất theo yêu cầu riêng của khách hàng. Nếu bạn không tìm thấy sản phẩm phù hợp trong bộ sưu tập của chúng tôi, hãy liên hệ để được tư vấn và thiết kế sản phẩm đáp ứng đúng nhu cầu và phong cách của bạn.</p>
                <p>Với đội ngũ thiết kế giàu kinh nghiệm và xưởng sản xuất hiện đại, chúng tôi có thể hiện thực hóa mọi ý tưởng của bạn về nội thất, từ những món đồ đơn lẻ đến toàn bộ không gian sống.</p>
                <a href="{% url 'contact' %}" class="btn btn-primary mt-3">Liên Hệ Tư Vấn</a>
            </div>
        </div>
    </div>
</section>
{% endblock %}
